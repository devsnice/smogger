{"version":3,"sources":["../../../src/components/parser/index.js"],"names":["getMethodModel","spec","path","method","paths","toLowerCase","getResponseModel","status","contentType","responses","content","schema","processor","cb","mutators","next","bind","properties","reduce","result","key","property","items","map","item","combiner","oneOf","anyOf","allOf"],"mappings":";;;;;;;AAAA;;AACA;;AAaO,MAAMA,cAEmC,GAAGC,IAAI,IAAI,CAACC,IAAD,EAAOC,MAAP,KACzDF,IAAI,CAACG,KAAL,CAAWF,IAAX,EAAiBC,MAAM,CAACE,WAAP,EAAjB,CAHK;;;;AAKA,MAAMC,gBAIF,GAAG,CAACH,MAAD,EAASI,MAAM,GAAG,GAAlB,EAAuBC,WAAW,GAAG,kBAArC,KACZL,MAAM,CAACM,SAAP,CAAiBF,MAAjB,EAAyBG,OAAzB,CAAiCF,WAAjC,EAA8CG,MALzC;;;;AAOA,MAAMC,SAIL,GAAG,CAACC,EAAD,EAAKC,QAAL,EAAeH,MAAf,KAA0B;AACnC,QAAMI,IAAI,GAAGH,SAAS,CAACI,IAAV,SAAqBH,EAArB,EAAyBC,QAAzB,CAAb;;AAEA,MAAIH,MAAM,CAACM,UAAX,EAAuB;AACrB,WAAO,oBAAQN,MAAM,CAACM,UAAf,EAA2BC,MAA3B,CAAkC,CAACC,MAAD,EAAS,CAACC,GAAD,EAAMC,QAAN,CAAT,KAA6B;AACpEF,MAAAA,MAAM,CAACC,GAAD,CAAN,GAAcL,IAAI,CAACM,QAAD,CAAlB;AACA,aAAOF,MAAP;AACD,KAHM,EAGJ,EAHI,CAAP;AAID;;AAED,MAAIR,MAAM,CAACW,KAAX,EAAkB;AAChB,QAAIR,QAAQ,CAACQ,KAAb,EAAoB;AAClB,aAAOR,QAAQ,CAACQ,KAAT,CAAeX,MAAf,EAAuBY,GAAvB,CAA2BC,IAAI,IAAIT,IAAI,CAACS,IAAD,CAAvC,CAAP;AACD;;AACD,WAAOT,IAAI,CAACJ,MAAM,CAACW,KAAR,CAAX;AACD;;AAED,MAAI,WAAWX,MAAX,IAAqB,WAAWA,MAAhC,IAA0C,WAAWA,MAAzD,EAAiE;AAC/D,QAAIc,QAAQ,GAAG,MAAMd,MAArB;;AACA,QAAIA,MAAM,CAACe,KAAX,EAAkB;AAChBD,MAAAA,QAAQ,GAAG,sBAAMd,MAAM,CAACe,KAAb,CAAX;AACD;;AACD,QAAIf,MAAM,CAACgB,KAAX,EAAkB;AAChBF,MAAAA,QAAQ,GAAG,sBAAMd,MAAM,CAACgB,KAAb,CAAX;AACD;;AACD,QAAIhB,MAAM,CAACiB,KAAX,EAAkB;AAChBH,MAAAA,QAAQ,GAAG,sBAAMd,MAAM,CAACiB,KAAb,CAAX;AACD;;AAED,WAAOb,IAAI,CAACU,QAAQ,EAAT,CAAX;AACD;;AAED,SAAOZ,EAAE,CAACF,MAAD,CAAT;AACD,CArCM","sourcesContent":["import { entries } from '../utils';\nimport { allOf, anyOf, oneOf } from './combiners';\nimport type {\n  OpenAPI,\n  Operation,\n  Paths,\n  Schema\n} from 'openapi3-flowtype-definition';\n\nexport type MutatorItems = (schema: Schema) => Array<any>;\nexport type Mutators = {\n  items?: MutatorItems\n};\n\nexport const getMethodModel: (\n  spec: OpenAPI\n) => (path: string, method: string) => Operation = spec => (path, method) =>\n  spec.paths[path][method.toLowerCase()];\n\nexport const getResponseModel: (\n  method: Operation,\n  status?: number,\n  contentType?: string\n) => Schema = (method, status = 200, contentType = 'application/json') =>\n  method.responses[status].content[contentType].schema;\n\nexport const processor: (\n  cb: (data: Schema) => any,\n  mutators: Mutators,\n  schema: Schema\n) => any = (cb, mutators, schema) => {\n  const next = processor.bind(this, cb, mutators);\n\n  if (schema.properties) {\n    return entries(schema.properties).reduce((result, [key, property]) => {\n      result[key] = next(property);\n      return result;\n    }, {});\n  }\n\n  if (schema.items) {\n    if (mutators.items) {\n      return mutators.items(schema).map(item => next(item));\n    }\n    return next(schema.items);\n  }\n\n  if ('oneOf' in schema || 'anyOf' in schema || 'allOf' in schema) {\n    let combiner = () => schema;\n    if (schema.oneOf) {\n      combiner = oneOf(schema.oneOf);\n    }\n    if (schema.anyOf) {\n      combiner = anyOf(schema.anyOf);\n    }\n    if (schema.allOf) {\n      combiner = allOf(schema.allOf);\n    }\n\n    return next(combiner());\n  }\n\n  return cb(schema);\n};\n"],"file":"index.js"}